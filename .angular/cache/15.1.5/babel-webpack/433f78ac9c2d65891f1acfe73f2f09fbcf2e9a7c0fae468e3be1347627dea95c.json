{"ast":null,"code":"import { Validators } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"src/app/Services/AnuncioService\";\nimport * as i3 from \"./../../../Services/CategoriaService\";\nimport * as i4 from \"ngx-toastr\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"@angular/router\";\nfunction CadastrarAnuncioComponent_option_21_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 24);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const categoria_r2 = ctx.$implicit;\n    i0.ɵɵpropertyInterpolate(\"value\", categoria_r2.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", categoria_r2.descricao, \" \");\n  }\n}\nconst _c0 = function () {\n  return [\"/gerencial-empresa\"];\n};\nexport class CadastrarAnuncioComponent {\n  constructor(fb, anuncioservice, categoriaService, toast) {\n    this.fb = fb;\n    this.anuncioservice = anuncioservice;\n    this.categoriaService = categoriaService;\n    this.toast = toast;\n    this.categorias = [];\n    this.empresaId = 0;\n    this.categoriaId = 0;\n    this.nomeArquivo = '';\n    this.imagemUrl = \"../../../../assets/images/icons/upload.png\";\n  }\n  ngOnInit() {\n    this.BuscarCategorias();\n  }\n  get f() {\n    return this.form.controls;\n  }\n  onChange(event) {\n    const selectedFiles = event.srcElement.files;\n    document.getElementById('imageLabel').innerHTML = selectedFiles[0].name;\n  }\n  validation() {\n    this.form = this.fb.group({\n      descricao: [null, [Validators.required, Validators.minLength(3), Validators.maxLength(150)]],\n      data_validade: ['', Validators.required],\n      preco: ['', Validators.required],\n      categoria: ['', Validators.required],\n      imagem: ['', Validators.required]\n    });\n  }\n  salvarAnuncio() {\n    debugger;\n    this.categoriaId = parseInt(document.getElementById('categoriaId').value);\n    this.empresaId = 3;\n    let anuncio = {\n      descricao: this.f.descricao.value,\n      data_validade: this.f.data_validade.value,\n      preco: this.f.preco.value,\n      ativo: true,\n      is_destaque: false,\n      categoria_id: this.categoriaId,\n      empresa_id: this.empresaId,\n      imagem_url: this.nomeArquivo\n    };\n    this.anuncioservice.SalvarAnuncio(anuncio).subscribe(() => {\n      this.toast.success('Anúncio cadastrado com sucesso!', 'Sucesso');\n    }, erro => {\n      this.toast.error('Erro ao cadastrar o anúncio.', 'Erro');\n    });\n  }\n  BuscarCategorias() {\n    this.categoriaService.BuscarTodasCategorias().subscribe(result => {\n      if (result != null) {\n        this.categorias = result;\n      }\n    }, () => {\n      alert(`Nenhuma categoria encontrada. Verifique a conexão com a internet.`);\n    });\n  }\n  onFileChange(ev) {\n    const reader = new FileReader();\n    reader.onload = event => this.imagemUrl = event.target.result;\n    this.file = ev.target.files;\n    reader.readAsDataURL(this.file[0]);\n    this.uploadImagem();\n  }\n  uploadImagem() {\n    this.anuncioservice.postUpload(this.file).subscribe(fileName => {\n      this.nomeArquivo = fileName;\n    }, error => {\n      alert('Erro ao enviar imagem para o servidor.');\n    });\n  }\n  inputChange(event) {\n    const files = event.target.files;\n    this.arquivoSelecionado = files?.item(0);\n    this.anuncioservice.EnviarArquivo(this.arquivoSelecionado).subscribe(nomeArquivo => {\n      this.nomeArquivo = nomeArquivo;\n      this.localUrl = this.arquivoSelecionado;\n      console.log(this.arquivoSelecionado);\n    });\n  }\n  selectFile(event) {\n    this.file = event.target.files[0];\n    if (event.target.files && event.target.files[0]) {\n      var reader = new FileReader();\n      reader.onload = event => {\n        this.localUrl = event.target.result;\n      };\n      reader.readAsDataURL(event.target.files[0]);\n    }\n  }\n}\nCadastrarAnuncioComponent.ɵfac = function CadastrarAnuncioComponent_Factory(t) {\n  return new (t || CadastrarAnuncioComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.AnuncioService), i0.ɵɵdirectiveInject(i3.CategoriaService), i0.ɵɵdirectiveInject(i4.ToastrService));\n};\nCadastrarAnuncioComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: CadastrarAnuncioComponent,\n  selectors: [[\"app-cadastrar-anuncio\"]],\n  decls: 37,\n  vars: 5,\n  consts: [[1, \"container\", \"card\", \"col-lg-6\", \"mt-3\"], [1, \"col-lg-12\", 2, \"padding\", \"25px\"], [1, \"card-header\", \"text-center\", 2, \"background-color\", \"darkblue\", \"color\", \"white\"], [3, \"formGroup\", \"ngSubmit\"], [1, \"card-body\", \"row\"], [1, \"form-group\", \"col-md-12\"], [\"for\", \"descricao\"], [\"type\", \"text\", \"formControlName\", \"descricao\", \"id\", \"descricao\", \"placeholder\", \"Digite a descri\\u00E7\\u00E3o do seu an\\u00FAncio\", 1, \"form-control\"], [1, \"form-group\", \"col-md-4\"], [\"type\", \"date\", \"formControlName\", \"data_validade\", 1, \"form-control\"], [\"for\", \"inputState\"], [\"id\", \"categoriaId\", 1, \"form-control\"], [\"selected\", \"\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"for\", \"preco\"], [\"type\", \"text\", \"formControlName\", \"preco\", \"id\", \"preco\", \"placeholder\", \"Ex: R$23,99\", 1, \"form-control\"], [1, \"form-group\", \"row\"], [\"for\", \"\", 1, \"col-md-4\"], [\"type\", \"file\", 2, \"display\", \"none\", 3, \"change\"], [\"file\", \"\"], [\"tooltip\", \"Upload de nova Imagem\", 1, \"image\", \"col-md-4\", 2, \"width\", \"20%\", 3, \"src\", \"click\"], [1, \"card-footer\", 2, \"margin\", \"10px\"], [1, \"btn\", \"btn-dark\", 2, \"margin-right\", \"15px\", 3, \"routerLink\"], [\"type\", \"submit\", 1, \"btn\", \"btn-success\"], [3, \"value\"]],\n  template: function CadastrarAnuncioComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      const _r3 = i0.ɵɵgetCurrentView();\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"h4\");\n      i0.ɵɵtext(4, \"Cadastro de An\\u00FAncio\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(5, \"form\", 3);\n      i0.ɵɵlistener(\"ngSubmit\", function CadastrarAnuncioComponent_Template_form_ngSubmit_5_listener() {\n        return ctx.salvarAnuncio();\n      });\n      i0.ɵɵelementStart(6, \"div\", 4)(7, \"div\", 5)(8, \"label\", 6);\n      i0.ɵɵtext(9, \"Descri\\u00E7\\u00E3o\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(10, \"input\", 7);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(11, \"div\", 8)(12, \"label\");\n      i0.ɵɵtext(13, \"V\\u00E1lido at\\u00E9\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(14, \"input\", 9);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(15, \"div\", 8)(16, \"label\", 10);\n      i0.ɵɵtext(17, \"Categoria\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(18, \"select\", 11)(19, \"option\", 12);\n      i0.ɵɵtext(20, \"Selecione...\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(21, CadastrarAnuncioComponent_option_21_Template, 2, 2, \"option\", 13);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(22, \"div\", 8)(23, \"label\", 14);\n      i0.ɵɵtext(24, \"Pre\\u00E7o\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(25, \"input\", 15);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(26, \"div\", 16)(27, \"label\", 17);\n      i0.ɵɵtext(28, \" Selecione a Imagem do Produto\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(29, \"input\", 18, 19);\n      i0.ɵɵlistener(\"change\", function CadastrarAnuncioComponent_Template_input_change_29_listener($event) {\n        return ctx.onFileChange($event);\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(31, \"img\", 20);\n      i0.ɵɵlistener(\"click\", function CadastrarAnuncioComponent_Template_img_click_31_listener() {\n        i0.ɵɵrestoreView(_r3);\n        const _r1 = i0.ɵɵreference(30);\n        return i0.ɵɵresetView(_r1.click());\n      });\n      i0.ɵɵelementEnd()()()();\n      i0.ɵɵelementStart(32, \"div\", 21)(33, \"button\", 22);\n      i0.ɵɵtext(34, \" Voltar \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(35, \"button\", 23);\n      i0.ɵɵtext(36, \"Salvar\");\n      i0.ɵɵelementEnd()()()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(5);\n      i0.ɵɵproperty(\"formGroup\", ctx.form);\n      i0.ɵɵadvance(16);\n      i0.ɵɵproperty(\"ngForOf\", ctx.categorias);\n      i0.ɵɵadvance(10);\n      i0.ɵɵproperty(\"src\", ctx.imagemUrl, i0.ɵɵsanitizeUrl);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(4, _c0));\n    }\n  },\n  dependencies: [i5.NgForOf, i6.RouterLink, i1.ɵNgNoValidate, i1.NgSelectOption, i1.ɵNgSelectMultipleOption, i1.DefaultValueAccessor, i1.NgControlStatus, i1.NgControlStatusGroup, i1.FormGroupDirective, i1.FormControlName],\n  styles: [\".custom-file-label[_ngcontent-%COMP%]::after {\\r\\n  position: absolute;\\r\\n  top: 0;\\r\\n  right: 0;\\r\\n  bottom: 0;\\r\\n  z-index: 3;\\r\\n  display: block;\\r\\n  height: calc(1.5em + 0.9rem);\\r\\n  padding: 0.45rem 0.85rem;\\r\\n  line-height: 1.5;\\r\\n  color: #495057;\\r\\n  content: \\\"Selecionar\\\";\\r\\n  background-color: #e4e4e4;\\r\\n  border-left: inherit;\\r\\n  border-radius: 0 0.37rem 0.37rem 0;\\r\\n}\\r\\n\\r\\n.cabecalhoAnuncio[_ngcontent-%COMP%]{\\r\\n  background-color: darkblue;\\r\\n  color: white;\\r\\n  padding: 10px;\\r\\n  margin-bottom: 10px;\\r\\n  border-radius: 15px;\\r\\n}\\r\\n\\r\\nimg[_ngcontent-%COMP%]{\\r\\n  cursor: pointer;\\r\\n  border: solid 1px rgb(185, 183, 183);\\r\\n  padding: 10px;\\r\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvQ29tcG9uZW50cy9BbnVuY2lvL2NhZGFzdHJhci1hbnVuY2lvL2NhZGFzdHJhci1hbnVuY2lvLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSxrQkFBa0I7RUFDbEIsTUFBTTtFQUNOLFFBQVE7RUFDUixTQUFTO0VBQ1QsVUFBVTtFQUNWLGNBQWM7RUFDZCw0QkFBNEI7RUFDNUIsd0JBQXdCO0VBQ3hCLGdCQUFnQjtFQUNoQixjQUFjO0VBQ2QscUJBQXFCO0VBQ3JCLHlCQUF5QjtFQUN6QixvQkFBb0I7RUFDcEIsa0NBQWtDO0FBQ3BDOztBQUVBO0VBQ0UsMEJBQTBCO0VBQzFCLFlBQVk7RUFDWixhQUFhO0VBQ2IsbUJBQW1CO0VBQ25CLG1CQUFtQjtBQUNyQjs7QUFFQTtFQUNFLGVBQWU7RUFDZixvQ0FBb0M7RUFDcEMsYUFBYTtBQUNmIiwic291cmNlc0NvbnRlbnQiOlsiLmN1c3RvbS1maWxlLWxhYmVsOjphZnRlciB7XHJcbiAgcG9zaXRpb246IGFic29sdXRlO1xyXG4gIHRvcDogMDtcclxuICByaWdodDogMDtcclxuICBib3R0b206IDA7XHJcbiAgei1pbmRleDogMztcclxuICBkaXNwbGF5OiBibG9jaztcclxuICBoZWlnaHQ6IGNhbGMoMS41ZW0gKyAwLjlyZW0pO1xyXG4gIHBhZGRpbmc6IDAuNDVyZW0gMC44NXJlbTtcclxuICBsaW5lLWhlaWdodDogMS41O1xyXG4gIGNvbG9yOiAjNDk1MDU3O1xyXG4gIGNvbnRlbnQ6IFwiU2VsZWNpb25hclwiO1xyXG4gIGJhY2tncm91bmQtY29sb3I6ICNlNGU0ZTQ7XHJcbiAgYm9yZGVyLWxlZnQ6IGluaGVyaXQ7XHJcbiAgYm9yZGVyLXJhZGl1czogMCAwLjM3cmVtIDAuMzdyZW0gMDtcclxufVxyXG5cclxuLmNhYmVjYWxob0FudW5jaW97XHJcbiAgYmFja2dyb3VuZC1jb2xvcjogZGFya2JsdWU7XHJcbiAgY29sb3I6IHdoaXRlO1xyXG4gIHBhZGRpbmc6IDEwcHg7XHJcbiAgbWFyZ2luLWJvdHRvbTogMTBweDtcclxuICBib3JkZXItcmFkaXVzOiAxNXB4O1xyXG59XHJcblxyXG5pbWd7XHJcbiAgY3Vyc29yOiBwb2ludGVyO1xyXG4gIGJvcmRlcjogc29saWQgMXB4IHJnYigxODUsIDE4MywgMTgzKTtcclxuICBwYWRkaW5nOiAxMHB4O1xyXG59XHJcbiJdLCJzb3VyY2VSb290IjoiIn0= */\"]\n});\nCadastrarAnuncioComponent.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: CadastrarAnuncioComponent,\n  factory: CadastrarAnuncioComponent.ɵfac\n});","map":{"version":3,"mappings":"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","names":["Validators","i0","CadastrarAnuncioComponent","constructor","fb","anuncioservice","categoriaService","toast","ngOnInit","BuscarCategorias","f","form","controls","onChange","event","selectedFiles","srcElement","files","document","getElementById","innerHTML","name","validation","group","descricao","required","minLength","maxLength","data_validade","preco","categoria","imagem","salvarAnuncio","categoriaId","parseInt","value","empresaId","anuncio","ativo","is_destaque","categoria_id","empresa_id","imagem_url","nomeArquivo","SalvarAnuncio","subscribe","success","erro","error","BuscarTodasCategorias","result","categorias","alert","onFileChange","ev","reader","FileReader","onload","imagemUrl","target","file","readAsDataURL","uploadImagem","postUpload","fileName","inputChange","arquivoSelecionado","item","EnviarArquivo","localUrl","console","log","selectFile","selectors","decls","vars","consts","template","ctx","factory"],"sourceRoot":"","sources":["D:\\projetos\\MarketingFront\\MarketingAppFront\\src\\app\\Components\\Anuncio\\cadastrar-anuncio\\cadastrar-anuncio.component.ts","D:\\projetos\\MarketingFront\\MarketingAppFront\\src\\app\\Components\\Anuncio\\cadastrar-anuncio\\cadastrar-anuncio.component.html"],"sourcesContent":["import { Anuncio } from './../../../Models/Anuncio';\nimport { CategoriaService } from './../../../Services/CategoriaService';\nimport { EmpresaService } from './../../../Services/EmpresaService';\nimport { AnuncioService } from 'src/app/Services/AnuncioService';\nimport { Empresa } from './../../../Models/Empresa';\nimport { Component, Injectable, OnInit } from '@angular/core';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { CategoriaAnuncio } from 'src/app/Models/CategoriaAnuncio';\nimport { ToastrService } from 'ngx-toastr';\n\n@Component({\n  selector: 'app-cadastrar-anuncio',\n  templateUrl: './cadastrar-anuncio.component.html',\n  styleUrls: ['./cadastrar-anuncio.component.css'],\n})\n\n@Injectable()\n\nexport class CadastrarAnuncioComponent implements OnInit {\n  form: FormGroup;\n  categorias: CategoriaAnuncio[] = [];\n  empresaId: number = 0;\n  categoriaId: number = 0;\n  localUrl: any;\n  file?: File;\n  nomeArquivo: string = '';\n  imagemUrl = \"../../../../assets/images/icons/upload.png\";\n  public arquivoSelecionado: File | null | undefined;\n\n  constructor(\n    private fb: FormBuilder,\n    private anuncioservice: AnuncioService,\n    private categoriaService: CategoriaService,\n    private toast: ToastrService\n  ) {\n  }\n\n  ngOnInit(): void {\n    this.BuscarCategorias();\n  }\n\n  get f() {\n    return this.form.controls;\n  }\n\n  onChange(event: any) {\n    const selectedFiles = <FileList>event.srcElement.files;\n    document.getElementById('imageLabel')!.innerHTML = selectedFiles[0].name;\n  }\n\n  public validation(): void{\n    this.form = this.fb.group({\n      descricao: [\n        null,\n        [\n          Validators.required,\n          Validators.minLength(3),\n          Validators.maxLength(150),\n        ],\n      ],\n      data_validade: ['', Validators.required],\n      preco: ['', Validators.required],\n      categoria: ['', Validators.required],\n      imagem: ['', Validators.required],\n    });\n  }\n\n  salvarAnuncio() {\n    debugger;\n    this.categoriaId = parseInt(\n      (<HTMLSelectElement>document.getElementById('categoriaId')).value\n    );\n    this.empresaId = 3;\n\n    let anuncio = {\n      descricao: this.f.descricao.value,\n      data_validade: this.f.data_validade.value,\n      preco: this.f.preco.value,\n      ativo: true,\n      is_destaque: false,\n      categoria_id: this.categoriaId,\n      empresa_id: this.empresaId,\n      imagem_url: this.nomeArquivo,\n    };\n\n    this.anuncioservice.SalvarAnuncio(anuncio)\n    .subscribe(\n      () => {\n        this.toast.success('Anúncio cadastrado com sucesso!', 'Sucesso');\n      },\n      (erro) => {\n        this.toast.error('Erro ao cadastrar o anúncio.', 'Erro');\n      }\n    );\n  }\n\n  BuscarCategorias() {\n    this.categoriaService.BuscarTodasCategorias().subscribe(\n      (result) => {\n        if (result != null) {\n          this.categorias = result;\n        }\n      },\n      () => {\n        alert(\n          `Nenhuma categoria encontrada. Verifique a conexão com a internet.`\n        );\n      }\n    );\n  }\n\n  onFileChange(ev :any) : void{\n\n    const reader = new FileReader();\n    reader.onload = (event : any) => this.imagemUrl = event.target.result;\n    this.file = ev.target.files;\n    reader.readAsDataURL(this.file[0]);\n    this.uploadImagem();\n  }\n\n  uploadImagem(): void{\n    this.anuncioservice.postUpload(this.file)\n    .subscribe(\n      (fileName) => {\n        this.nomeArquivo = fileName;\n      },\n      (error: any) => {\n        alert('Erro ao enviar imagem para o servidor.');\n      }\n    )\n  }\n\n  inputChange(event: Event) {\n    const files = (event.target as HTMLInputElement).files;\n    this.arquivoSelecionado = files?.item(0);\n    this.anuncioservice\n      .EnviarArquivo(this.arquivoSelecionado!)\n      .subscribe((nomeArquivo) => {\n        this.nomeArquivo = nomeArquivo;\n        this.localUrl = this.arquivoSelecionado;\n        console.log(this.arquivoSelecionado);\n      });\n  }\n\n  selectFile(event: any) {\n    this.file = <File>event.target.files[0];\n    if (event.target.files && event.target.files[0]) {\n      var reader = new FileReader();\n      reader.onload = (event: any) => {\n        this.localUrl = event.target.result;\n      };\n      reader.readAsDataURL(event.target.files[0]);\n    }\n  }\n}\n","  <div class=\"container card col-lg-6 mt-3\">\n    <div class=\"col-lg-12\" style=\" padding: 25px; \">\n      <div class=\"card-header text-center\" style=\"background-color: darkblue; color: white;\">\n        <h4>Cadastro de Anúncio</h4>\n      </div>\n      <form (ngSubmit)=\"salvarAnuncio()\" [formGroup]=\"form\">\n        <div class=\"card-body row\">\n          <div class=\"form-group col-md-12\">\n            <label for=\"descricao\">Descrição</label>\n            <input\n              type=\"text\"\n              class=\"form-control\"\n              formControlName=\"descricao\"\n              id=\"descricao\"\n              placeholder=\"Digite a descrição do seu anúncio\"\n            />\n          </div>\n          <div class=\"form-group col-md-4\">\n            <label>Válido até</label>\n            <input type=\"date\" class=\"form-control\" formControlName=\"data_validade\" />\n          </div>\n          <div class=\"form-group col-md-4\">\n            <label for=\"inputState\">Categoria</label>\n            <select id=\"categoriaId\" class=\"form-control\">\n              <option selected>Selecione...</option>\n              <option *ngFor=\"let categoria of categorias\" value=\"{{ categoria.id }}\">\n                {{ categoria.descricao }}\n              </option>\n            </select>\n          </div>\n          <div class=\"form-group col-md-4\">\n            <label for=\"preco\">Preço</label>\n            <input\n              type=\"text\"\n              class=\"form-control\"\n              formControlName=\"preco\"\n              id=\"preco\"\n              placeholder=\"Ex: R$23,99\"\n            />\n          </div>\n            <div class=\"form-group row\">\n              <label class=\"col-md-4\" for=\"\"> Selecione a Imagem do Produto</label>\n              <input type=\"file\" #file (change)=\"onFileChange($event)\" style=\"display: none;\">\n              <img class=\"image col-md-4\" [src]=\"imagemUrl\" (click)=\"file.click()\" style=\"width: 20%\" tooltip=\"Upload de nova Imagem\">\n            </div>\n      </div>\n    </form>\n        <div class=\"card-footer\" style=\"margin: 10px\">\n          <button class=\"btn btn-dark\" style=\"margin-right: 15px\" [routerLink]=\"['/gerencial-empresa']\">\n            Voltar\n          </button>\n          <button type=\"submit\" class=\"btn btn-success\">Salvar</button>\n        </div>\n    </div>\n  </div>\n\n\n\n\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}